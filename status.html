<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot å®æ—¶çŠ¶æ€ - æœˆå¼¦é˜</title>
    <link rel="stylesheet" href="bot_style.css">
</head>
<body>
    <header>
        <div class="brand"><h1><a href="index.html">æœˆå¼¦é˜</a></h1></div>
        <nav class="nav-links"><a href="index.html">ğŸ  è¿”å›ä¸»é¡µ</a></nav>
    </header>

    <main>
        <div class="hero-box">
            <h2>ğŸ“¡ çœ‹çœ‹ä½ çš„botè¿˜æ´»ç€å—</h2>
            <p>å®æ—¶ç›‘æ§æ‰€æœ‰æœºå™¨äººè´¦å·çš„å­˜æ´»çŠ¶æ€</p>
            <div id="network-status">æ­£åœ¨è¿æ¥...</div>
        </div>

        <div id="container" class="status-grid">
            <div style="text-align:center;width:100%;color:#888">æ­£åœ¨åŠ è½½æ•°æ®...</div>
        </div>
    </main>

    <script>
        let API_BASE = '';
        if (window.location.hostname.includes('akiyo.fun')) {
            API_BASE = '/api/bot';
            document.getElementById('network-status').innerText = 'Mode: Online';
        } else {
            API_BASE = 'http://127.0.0.1:5001';
            document.getElementById('network-status').innerText = 'Mode: Local Debug';
        }

        const API_URL = API_BASE + '/accounts';

        fetch(API_URL)
            .then(r => r.json())
            .then(data => {
                const box = document.getElementById('container');
                box.innerHTML = '';
                if(!data.length) { 
                    box.innerHTML='<div style="text-align:center;width:100%; color:#aaa;">æš‚æ— è´¦å·æ•°æ®</div>'; 
                    return; 
                }
                
                data.forEach(item => {
                    let badge = '';
                    let detailHtml = '';
                    
                    // å¤‡æ³¨æ ‡ç­¾æ ·å¼
                    const noteHtml = item.note 
                        ? `<span style="font-size:0.8rem; background:rgba(255, 215, 0, 0.15); color:#ffd700; padding:2px 6px; border-radius:4px; border:1px solid rgba(255, 215, 0, 0.3); vertical-align:middle; margin-left:8px;">${item.note}</span>` 
                        : '';

                    if(item.status === 'ok') {
                        badge = '<span class="badge bg-green">âœ… è¿è¡Œæ­£å¸¸</span>';
                    } else if(item.status === 'temp') {
                        badge = '<span class="badge bg-yellow">â³ ä¸´æ—¶å†»ç»“</span>';
                        detailHtml = `<div class="detail">ğŸ“… é¢„è®¡è§£å°: <span style="color:#fff;font-weight:bold;">${item.unban_date}</span></div>`;
                    } else {
                        badge = '<span class="badge bg-red">ğŸš« æ°¸ä¹…å°ç¦</span>';
                        detailHtml = `<div class="detail">æ­¤è´¦å·å·²è¢«æ°¸ä¹…åœç”¨</div>`;
                    }

                    box.innerHTML += `
                        <div class="bot-card">
                            <img class="avatar" src="http://q1.qlogo.cn/g?b=qq&nk=${item.qq}&s=100" onerror="this.src='imgs/Helper.jpg'">
                            <div class="info">
                                <div class="name">
                                    ${item.name}
                                    ${noteHtml}
                                </div>
                                <span class="qq">${item.qq}</span>
                                ${badge}
                                ${detailHtml}
                            </div>
                        </div>`;
                });
            })
            .catch(err => {
                document.getElementById('container').innerHTML = `<div style="text-align:center;color:#ef5350">è¿æ¥å¤±è´¥</div>`;
            });
    </script>
</body>
</html>